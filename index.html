<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CHART IN BIO</title>
  <link rel="icon" type="https://i.postimg.cc/kG5V5Qk4/Picsart-25-10-09-15-34-05-434.png">
<style>   
    :root {
      --bg-primary: #0B0E11;
      --bg-secondary: #161A1E;
      --bg-card: rgba(22, 26, 30, 0.9);
      --bg-gradient: linear-gradient(135deg, #0B0E11 0%, #1A1D23 100%);
      --accent-primary: #F0B90B;
      --accent-secondary: #F8D33A;
      --accent-gradient: linear-gradient(135deg, #F0B90B 0%, #F8D33A 100%);
      --text-primary: #EAECEF;
      --text-secondary: #B7BDC6;
      --text-muted: #848E9C;
      --border-light: rgba(240, 185, 11, 0.1);
      --border-medium: rgba(240, 185, 11, 0.15);
      --border-accent: rgba(240, 185, 11, 0.3);
      --success: #0ECB81;
      --warning: #F0B90B;
      --danger: #F6465D;
      --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.6);
      --shadow-xl: 0 20px 40px -10px rgba(0, 0, 0, 0.7);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --radius-xl: 20px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      margin: 0;
      min-height: 100vh;
      background: var(--bg-gradient);
      color: var(--text-primary);
      display: flex;
      flex-direction: column;
      padding: 0;
      line-height: 1.6;
    }

    /* Header Styles */
    .main-header {
      background: var(--bg-card);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-light);
      padding: 12px 16px;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: var(--accent-primary);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 18px;
      color: #0B0E11;
    }

    .logo-text {
      font-size: 18px;
      font-weight: 700;
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .nav-links {
      display: none;
    }

    .wallet-section {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .network-selector {
      position: relative;
      display: flex;
      align-items: center;
    }

    .network-logo {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--border-light);
      cursor: pointer;
      transition: all 0.2s ease;
      overflow: hidden;
    }

    .network-logo:hover {
      border-color: var(--accent-primary);
      transform: scale(1.05);
    }

    .network-logo img {
      width: 20px;
      height: 20px;
      object-fit: contain;
    }

    .network-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 8px;
      background: var(--bg-card);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-md);
      padding: 8px;
      min-width: 180px;
      box-shadow: var(--shadow-lg);
      display: none;
      z-index: 101;
      backdrop-filter: blur(10px);
    }

    .network-dropdown.active {
      display: block;
      animation: fadeIn 0.2s ease-out;
    }

    .network-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .network-option:hover {
      background: rgba(240, 185, 11, 0.1);
    }

    .network-option.active {
      background: rgba(240, 185, 11, 0.15);
    }

    .network-option-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .network-option-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .network-option-name {
      font-size: 14px;
      font-weight: 500;
    }

    .wallet-address {
      font-size: 12px;
      color: var(--text-secondary);
      background: rgba(11, 14, 17, 0.8);
      padding: 8px 12px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-light);
      max-width: 120px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Modal de Conex√£o */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(11, 14, 17, 0.8);
      backdrop-filter: blur(5px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 24px;
      width: 90%;
      max-width: 400px;
      border: 1px solid var(--border-light);
      box-shadow: var(--shadow-xl);
      animation: fadeIn 0.3s ease-out;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 700;
      margin: 0;
    }

    .close-modal {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      padding: 4px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-modal:hover {
      background: rgba(240, 185, 11, 0.1);
      color: var(--accent-primary);
    }

    .wallet-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .wallet-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: rgba(11, 14, 17, 0.6);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .wallet-option:hover {
      border-color: var(--accent-primary);
      background: rgba(240, 185, 11, 0.05);
    }

    .wallet-icon {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      background: var(--bg-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .wallet-name {
      font-weight: 600;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px 16px;
      padding-bottom: 80px;
    }

    .card {
      width: 100%;
      max-width: 980px;
      background: var(--bg-card);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-xl);
      padding: 24px;
      box-shadow: var(--shadow-xl);
      border: 1px solid var(--border-light);
      transition: all 0.3s ease;
    }

    .card:hover {
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
      border-color: var(--border-accent);
    }

    .page-header {
      margin-bottom: 28px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-light);
    }

    .page-title {
      font-size: 22px;
      margin: 0;
      font-weight: 700;
      color: var(--text-primary);
    }

    .page-subtitle {
      color: var(--text-secondary);
      font-size: 14px;
      margin-top: 8px;
    }

    button {
      background: var(--accent-primary);
      border: none;
      padding: 12px 16px;
      border-radius: var(--radius-md);
      color: #0B0E11;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 6px rgba(240, 185, 11, 0.25);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(240, 185, 11, 0.35);
      background: var(--accent-secondary);
    }

    button:active {
      transform: translateY(0);
    }

    button.secondary {
      background: transparent;
      border: 1px solid var(--border-medium);
      color: var(--text-secondary);
      box-shadow: none;
    }

    button.secondary:hover {
      background: rgba(240, 185, 11, 0.1);
      color: var(--accent-primary);
      border-color: var(--accent-primary);
    }

    button.danger {
      background: var(--danger);
      color: white;
      box-shadow: 0 4px 6px rgba(246, 70, 93, 0.25);
    }

    button.danger:hover {
      box-shadow: 0 6px 12px rgba(246, 70, 93, 0.35);
      background: #ff5c75;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 28px;
    }

    .form-section {
      margin-bottom: 24px;
    }

    label {
      display: block;
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 8px;
      font-weight: 500;
    }

    input[type=text], textarea, select {
      width: 100%;
      padding: 14px 16px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-medium);
      background: rgba(11, 14, 17, 0.6);
      color: var(--text-primary);
      font-size: 15px;
      transition: all 0.2s ease;
      resize: vertical;
      min-height: 44px;
    }

    textarea {
      min-height: 100px;
      font-family: inherit;
    }

    input[type=text]:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(240, 185, 11, 0.2);
    }

    .profile-preview {
      background: var(--bg-secondary);
      padding: 20px;
      border-radius: var(--radius-lg);
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: all 0.3s ease;
      width: 100%;
      border: 1px solid var(--border-light);
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
    }

    .profile-preview::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--accent-gradient);
    }

    .avatar {
      width: 120px;
      height: 120px;
      border-radius: var(--radius-lg);
      background: var(--bg-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      border: 3px solid var(--border-light);
      margin-bottom: 16px;
      transition: all 0.3s ease;
    }

    .avatar:hover {
      transform: scale(1.03);
      border-color: var(--accent-primary);
    }

    .avatar-placeholder {
      color: var(--text-muted);
      font-size: 14px;
      text-align: center;
      padding: 16px;
    }

    .links {
      margin-top: 20px;
      width: 100%;
    }

    .link-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 12px;
      align-items: stretch;
    }

    .link-item-row {
      display: flex;
      gap: 8px;
      width: 100%;
    }

    .link-item-row input {
      flex: 1;
    }

    .link-item button {
      padding: 10px 12px;
      background: var(--bg-primary);
      border: 1px solid var(--border-medium);
      color: var(--text-secondary);
      box-shadow: none;
      width: 100%;
      justify-content: center;
    }

    .link-item button:hover {
      background: var(--danger);
      color: white;
      transform: none;
    }

    .small {
      font-size: 13px;
      color: var(--text-muted);
    }

    .muted-block {
      background: rgba(240, 185, 11, 0.03);
      padding: 16px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-light);
      margin: 20px 0;
    }

    .actions {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: stretch;
      margin-top: 24px;
    }

    footer {
      margin-top: 24px;
      display: flex;
      gap: 16px;
      justify-content: space-between;
      flex-wrap: wrap;
      padding-top: 20px;
      border-top: 1px solid var(--border-light);
    }

    .network-info {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .network-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--success);
    }

    .preview-description {
      margin-top: 16px;
      text-align: center;
      color: var(--text-secondary);
      font-size: 14px;
      line-height: 1.5;
      max-height: 100px;
      overflow-y: auto;
      padding: 0 8px;
      width: 100%;
    }

    /* Footer Mobile */
    .mobile-footer {
      display: none;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-card);
      backdrop-filter: blur(10px);
      border-top: 1px solid var(--border-light);
      padding: 12px 16px;
      z-index: 90;
    }

    .mobile-nav {
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    .mobile-nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      text-decoration: none;
      color: var(--text-secondary);
      font-size: 10px;
      transition: all 0.2s ease;
      padding: 8px;
      border-radius: var(--radius-sm);
    }

    .mobile-nav-item.active,
    .mobile-nav-item:hover {
      color: var(--accent-primary);
      background: rgba(240, 185, 11, 0.05);
    }

    .mobile-nav-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- RESPONSIVIDADE --- */
    @media (max-width: 880px) {
      .main-header {
        padding: 12px 16px;
      }

      .logo-text {
        font-size: 16px;
      }

      .logo-icon {
        width: 28px;
        height: 28px;
        font-size: 16px;
      }

      .wallet-address {
        max-width: 100px;
        font-size: 11px;
        padding: 6px 10px;
      }

      button {
        padding: 10px 14px;
        font-size: 13px;
      }

      .mobile-footer {
        display: block;
      }

      .main-content {
        padding-bottom: 80px;
      }

      footer {
        justify-content: center;
        text-align: center;
      }

      .muted-block .desktop-text {
        display: none;
      }

      .muted-block .mobile-text {
        display: block;
      }

      /* Melhorias para formul√°rios em mobile */
      .form-section {
        margin-bottom: 20px;
      }

      input[type=text], textarea, select {
        padding: 12px 14px;
        font-size: 16px;
      }

      textarea {
        min-height: 120px;
      }

      .link-item {
        gap: 10px;
      }

      .link-item-row {
        flex-direction: column;
        gap: 10px;
      }

      .link-item-row input {
        width: 100%;
      }

      .actions button {
        width: 100%;
        justify-content: center;
      }

      /* Reorganiza√ß√£o do grid para mobile - preview primeiro */
      .grid {
        display: flex;
        flex-direction: column;
      }

      .grid aside {
        order: -1;
        margin-bottom: 28px;
      }

      /* Modal com anima√ß√£o de baixo para cima em mobile */
      .modal {
        align-items: flex-end;
        justify-content: center;
      }

      .modal-content {
        width: 100%;
        max-width: none;
        border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        animation: slideUp 0.3s ease-out;
        margin-bottom: 0;
      }
    }

    @media (min-width: 881px) {
      .muted-block .mobile-text {
        display: none;
      }

      .grid {
        grid-template-columns: 1fr 360px;
      }

      .link-item {
        flex-direction: row;
        align-items: center;
      }

      .link-item-row {
        flex-direction: row;
      }

      .actions {
        flex-direction: row;
        align-items: center;
      }

      .actions button {
        width: auto;
      }

      /* Garante que no desktop o preview fique √† direita */
      .grid aside {
        order: 0;
      }

      /* Modal centralizado no desktop */
      .modal {
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        animation: fadeIn 0.3s ease-out;
      }
    }

    @media (max-width: 480px) {
      .card {
        padding: 20px;
      }

      .page-title {
        font-size: 20px;
      }

      input[type=text], textarea, select {
        font-size: 16px;
        padding: 12px;
      }

      .muted-block {
        font-size: 12px;
      }

      button {
        font-size: 14px;
        padding: 12px;
      }

      .avatar {
        width: 100px;
        height: 100px;
      }

      .logo-text {
        font-size: 16px;
      }

      .wallet-address {
        max-width: 90px;
        font-size: 10px;
        padding: 6px 8px;
      }

      .mobile-nav-item {
        font-size: 9px;
      }

      .network-dropdown {
        min-width: 160px;
        right: -10px;
      }

      .modal-content {
        padding: 20px;
      }
    }

    /* Anima√ß√µes */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Anima√ß√£o de slide up para mobile */
    @keyframes slideUp {
      from { 
        opacity: 0; 
        transform: translateY(100%); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0); 
      }
    }

    .card, .profile-preview {
      animation: fadeIn 0.5s ease-out;
    }

    /* Scrollbar personalizada */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(11, 14, 17, 0.5);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--accent-primary);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--accent-secondary);
    }

    /* Estilos para o campo de token contract (inicialmente oculto) */
    .token-contract-field {
      display: none;
      margin-top: 12px;
      animation: fadeIn 0.3s ease-out;
    }

    .token-contract-field.visible {
      display: block;
    }

    /* Estilos para os checkboxes de cargos */
    .roles-section {
      display: none;
      margin-top: 12px;
      animation: fadeIn 0.3s ease-out;
    }

    .roles-section.visible {
      display: block;
    }

    .roles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
      margin-top: 8px;
    }

    .role-checkbox {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      background: rgba(11, 14, 17, 0.6);
      border: 1px solid var(--border-medium);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .role-checkbox:hover {
      border-color: var(--accent-primary);
      background: rgba(240, 185, 11, 0.05);
    }

    .role-checkbox input[type="checkbox"] {
      margin: 0;
      width: 16px;
      height: 16px;
      accent-color: var(--accent-primary);
    }

    .role-checkbox.checked {
      border-color: var(--accent-primary);
      background: rgba(240, 185, 11, 0.1);
    }

    /* Estilos para os emblemas no preview */
    .badges-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 12px 0;
      justify-content: center;
    }

    .badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .badge.ceo {
      background: linear-gradient(135deg, #FF6B6B, #EE5A24);
      color: white;
    }

    .badge.coo {
      background: linear-gradient(135deg, #48DBFB, #18DCFF);
      color: #0B0E11;
    }

    .badge.cto {
      background: linear-gradient(135deg, #32FF7E, #18DC66);
      color: #0B0E11;
    }

    .badge.cfo {
      background: linear-gradient(135deg, #FF9F1C, #FFAF40);
      color: #0B0E11;
    }

    .badge.cmo {
      background: linear-gradient(135deg, #FF8CDB, #FF6FD8);
      color: #0B0E11;
    }

    .badge.dev {
      background: linear-gradient(135deg, #7158E2, #8B78E6);
      color: white;
    }

    .token-contract-preview {
      margin: 12px 0;
      padding: 10px;
      background: rgba(240, 185, 11, 0.1);
      border-radius: var(--radius-md);
      border: 1px solid var(--accent-primary);
      text-align: center;
      font-size: 12px;
      word-break: break-all;
    }

    .token-contract-preview a {
      color: var(--accent-primary);
      text-decoration: none;
    }

    .token-contract-preview a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="main-header">
    <div class="header-content">

<div class="logo-section">
  <a href="#" class="logo">
 <!--   <img src="https://github.com/shitcoinheiros/link-em-cadeia/blob/main/Logo%20TIEBIO.png?raw=true" alt="Logo TieBIO" class="logo-icon">  -->
    <div class="logo-text">TieBio</div>
  </a>
</div>
      

    

    
      
      <div class="wallet-section">
        <div class="network-selector">
          <div class="network-logo" id="networkLogo">
            <img src="https://assets.coingecko.com/coins/images/825/small/bnb-icon2_2x.png" alt="BNB Chain">
          </div>
          <div class="network-dropdown" id="networkDropdown">
            <div class="network-option active" data-chain="bsc">
              <div class="network-option-icon">
                <img src="https://assets.coingecko.com/coins/images/825/small/bnb-icon2_2x.png" alt="BNB Chain">
              </div>
              <div class="network-option-name">BNB Chain</div>
            </div>
            <div class="network-option" data-chain="ethereum">
              <div class="network-option-icon">
                <img src="https://assets.coingecko.com/coins/images/279/small/ethereum.png" alt="Ethereum">
              </div>
              <div class="network-option-name">Ethereum</div>
            </div>
            <div class="network-option" data-chain="polygon">
              <div class="network-option-icon">
                <img src="https://assets.coingecko.com/coins/images/4713/small/matic-token-icon.png" alt="Polygon">
              </div>
              <div class="network-option-name">Polygon</div>
            </div>
            <div class="network-option" data-chain="base">
              <div class="network-option-icon">
                <img src="https://altcoinsbox.com/wp-content/uploads/2023/02/base-logo-in-blue.webp" alt="Base">
              </div>
              <div class="network-option-name">Base</div>
            </div>
            <div class="network-option" data-chain="avalanche">
              <div class="network-option-icon">
                <img src="https://assets.coingecko.com/coins/images/12559/small/Avalanche_Circle_RedWhite_Trans.png" alt="Avalanche">
              </div>
              <div class="network-option-name">Avalanche</div>
            </div>
          </div>
        </div>
        <span id="walletAddr" class="wallet-address">n√£o conectado</span>
        <button id="connectBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 9H21V11H13V9ZM13 13H21V15H13V13ZM13 17H21V19H13V17ZM4 19H10V21H4C2.9 21 2 20.1 2 19V5C2 3.9 2.9 3 4 3H10V5H4V19ZM7 11H9V9H7V11ZM7 15H9V13H7V15ZM7 19H9V17H7V19Z" fill="currentColor"/>
          </svg>
          Conectar
        </button>
      </div>
    </div>
  </header>

  <!-- Modal de Conex√£o -->
  <div class="modal" id="walletModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Conectar Carteira</h2>
        <button class="close-modal" id="closeModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 6.41L17.59 8.41L18.17 11H8V13H18.17L15.59 15.58L17 17L22 12L17 7ZM4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z" fill="currentColor"/>
          </svg>
        </button>
      </div>
      <div class="wallet-options">
        <div class="wallet-option" id="metamaskOption">
          <div class="wallet-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 7L12 14L3 7V5L12 12L21 5V7Z" fill="#F6851B"/>
            </svg>
          </div>
          <div class="wallet-name">MetaMask</div>
        </div>
        <div class="wallet-option" id="walletconnectOption">
          <div class="wallet-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z" fill="#3B99FC"/>
            </svg>
          </div>
          <div class="wallet-name">WalletConnect</div>
        </div>
        <div class="wallet-option" id="binanceOption">
          <div class="wallet-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z" fill="#F0B90B"/>
            </svg>
          </div>
          <div class="wallet-name">Binance Chain</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="card">
      <div class="page-header">
        <h1 class="page-title">Criar / Editar Perfil</h1>
        <p class="page-subtitle">Gerencie sua identidade Web3 na blockchain</p>
      </div>

      <div class="grid">
        <div>
          <!-- Nova se√ß√£o: Tipo de Perfil -->
          <div class="form-section">
            <label for="profileType">Tipo de Perfil</label>
            <select id="profileType">
              <option value="personal">Perfil Pessoal</option>
              <option value="project">Perfil de Projeto</option>
            </select>
          </div>

          <!-- Campo condicional para Token Contract (Projeto) -->
          <div class="form-section token-contract-field" id="tokenContractField">
            <label for="tokenContract">Endere√ßo do Contrato do Token</label>
            <input id="tokenContract" type="text" placeholder="0x..." />
            <div class="small" style="margin-top: 4px;">
              Cole o endere√ßo do contrato do token do seu projeto
            </div>
          </div>

          <!-- Campo condicional para Cargos (Pessoal) -->
          <div class="form-section roles-section" id="rolesSection">
            <label>Cargos no Projeto</label>
            <div class="small" style="margin-bottom: 8px;">
              Selecione os cargos que voc√™ representa no projeto
            </div>
            <div class="roles-grid">
              <label class="role-checkbox" data-role="ceo">
                <input type="checkbox" value="ceo">
                <span>CEO</span>
              </label>
              <label class="role-checkbox" data-role="coo">
                <input type="checkbox" value="coo">
                <span>COO</span>
              </label>
              <label class="role-checkbox" data-role="cto">
                <input type="checkbox" value="cto">
                <span>CTO</span>
              </label>
              <label class="role-checkbox" data-role="cfo">
                <input type="checkbox" value="cfo">
                <span>CFO</span>
              </label>
              <label class="role-checkbox" data-role="cmo">
                <input type="checkbox" value="cmo">
                <span>CMO</span>
              </label>
              <label class="role-checkbox" data-role="dev">
                <input type="checkbox" value="dev">
                <span>DEV</span>
              </label>
            </div>
          </div>

          <div class="form-section">
            <label for="name">Nome</label>
            <input id="name" type="text" placeholder="Seu nome p√∫blico (ex: @william)" />
          </div>

          <div class="form-section">
            <label for="description">Descri√ß√£o</label>
            <textarea id="description" placeholder="Fale um pouco sobre voc√™, seus interesses, projetos... (m√°x. 500 caracteres)" maxlength="500"></textarea>
            <div class="small" style="text-align: right; margin-top: 4px;">
              <span id="charCount">0</span>/500 caracteres
            </div>
          </div>

          <div class="form-section">
            <label for="photo">Foto (URL)</label>
            <input id="photo" type="text" placeholder="https://.../avatar.jpg" />
          </div>

          <div class="form-section" id="linksBox">
            <label>Links (rede social, site, etc.)</label>
            <div id="linksList"></div>
            <div style="margin-top:12px">
              <button id="addLinkBtn" type="button" class="secondary">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="currentColor"/>
                </svg>
                Adicionar link
              </button>
            </div>
          </div>

          <!-- Bloco informativo - vers√£o desktop -->
          <div class="muted-block small desktop-text">
            Personalize sua p√°gina e veja as mudan√ßas ao vivo no painel √† direita.
          </div>

          <div class="actions">
            <button id="saveBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M17 3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V7L17 3ZM12 19C10.34 19 9 17.66 9 16C9 14.34 10.34 13 12 13C13.66 13 15 14.34 15 16C15 17.66 13.66 19 12 19ZM15 9H5V5H15V9Z" fill="currentColor"/>
              </svg>
              Salvar na blockchain
            </button>
            <button id="previewBtn" type="button" class="secondary">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 4.5C7 4.5 2.73 7.61 1 12C2.73 16.39 7 19.5 12 19.5C17 19.5 21.27 16.39 23 12C21.27 7.61 17 4.5 12 4.5ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17ZM12 9C10.34 9 9 10.34 9 12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12C15 10.34 13.66 9 12 9Z" fill="currentColor"/>
              </svg>
              Abrir p√°gina p√∫blica
            </button>
          </div>
        </div>

        <aside>
          <div class="profile-preview" id="previewBox">
            <div class="avatar">
              <div class="avatar-placeholder" id="avatarPlaceholder">Adicione uma URL de imagem</div>
              <img id="avatarImg" src="" alt="avatar" style="width:100%;height:100%;object-fit:cover;display:none"/>
            </div>
            <div style="margin-top:12px;text-align:center">
              <div id="previewName" style="font-weight:700;font-size:20px">Nome</div>
              <div id="previewAddr" class="small" style="margin-top:4px">endere√ßo</div>
              <!-- Nova linha para mostrar o tipo de perfil no preview -->
              <div id="previewType" class="small" style="margin-top:2px;color:var(--accent-primary);font-weight:600"></div>
            </div>
            <div class="preview-description" id="previewDescription">
              Sua descri√ß√£o aparecer√° aqui...
            </div>
            
            <!-- Container para o contrato de token (Projeto) -->
            <div id="tokenContractPreview" class="token-contract-preview" style="display: none;">
              <strong>Token Contract:</strong><br>
              <span id="previewTokenContract">‚Äî</span>
            </div>
            
            <!-- Container para os emblemas de cargos (Pessoal) -->
            <div id="badgesPreview" class="badges-container" style="display: none;"></div>
            
            <div class="links" id="previewLinks"></div>
          </div>
          
          <!-- Bloco informativo - vers√£o mobile -->
          <div class="muted-block small mobile-text">
            Personalize sua p√°gina e veja as mudan√ßas ao vivo no painel acima.
          </div>
          
          <div style="margin-top:16px;font-size:14px;color:var(--text-secondary);font-weight:500">Link p√∫blico (ap√≥s salvar):</div>
          <div id="publicLink" class="small" style="word-break:break-all;margin-top:6px;padding:10px;background:rgba(240,185,11,0.03);border-radius:var(--radius-md);border:1px solid var(--border-light)">‚Äî</div>
        </aside>
      </div>

      <footer>
        <div class="network-info">
          <div class="network-indicator"></div>
          <div class="small">Rede: <span id="networkName">‚Äî</span></div>
        </div>
        <div class="small">Linkchain ‚Ä¢ DApp de Perfil Web3</div>
      </footer>
    </div>
  </main>

  <!-- Footer Mobile -->
  <footer class="mobile-footer">
    <nav class="mobile-nav">
      <a href="#" class="mobile-nav-item active">
        <div class="mobile-nav-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 20V14H14V20H19V12H22L12 3L2 12H5V20H10Z" fill="currentColor"/>
          </svg>
        </div>
        <span>In√≠cio</span>
      </a>
      <a href="#" class="mobile-nav-item">
        <div class="mobile-nav-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z" fill="currentColor"/>
            <path d="M12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17Z" fill="currentColor"/>
          </svg>
        </div>
        <span>Explorar</span>
      </a>
      <a href="#" class="mobile-nav-item">
        <div class="mobile-nav-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z" fill="currentColor"/>
          </svg>
        </div>
        <span>Docs</span>
      </a>
      <a href="#" class="mobile-nav-item">
        <div class="mobile-nav-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM20 16H5.17L4 17.17V4H20V16Z" fill="currentColor"/>
            <path d="M7 9H17V11H7V9ZM7 12H15V14H7V12Z" fill="currentColor"/>
          </svg>
        </div>
        <span>Suporte</span>
      </a>
    </nav>
  </footer>

  <script>
import { ethers } from "https://cdn.jsdelivr.net/npm/ethers@6.11.1/dist/ethers.min.js";

// Configura√ß√µes das redes blockchain
const NETWORKS = {
  bsc: {
    chainId: "0x38",
    chainName: "Binance Smart Chain",
    rpcUrls: ["https://bsc-dataseed.binance.org/"],
    nativeCurrency: { name: "BNB", symbol: "BNB", decimals: 18 },
    blockExplorerUrls: ["https://bscscan.com"]
  },
  bscTestnet: {
    chainId: "0x61",
    chainName: "Binance Smart Chain Testnet",
    rpcUrls: ["https://data-seed-prebsc-1-s1.binance.org:8545/"],
    nativeCurrency: { name: "tBNB", symbol: "tBNB", decimals: 18 },
    blockExplorerUrls: ["https://testnet.bscscan.com"]
  },
  ethereum: {
    chainId: "0x1",
    chainName: "Ethereum Mainnet",
    rpcUrls: ["https://mainnet.infura.io/v3/"],
    nativeCurrency: { name: "Ether", symbol: "ETH", decimals: 18 },
    blockExplorerUrls: ["https://etherscan.io"]
  },
  polygon: {
    chainId: "0x89",
    chainName: "Polygon Mainnet",
    rpcUrls: ["https://polygon-rpc.com/"],
    nativeCurrency: { name: "MATIC", symbol: "MATIC", decimals: 18 },
    blockExplorerUrls: ["https://polygonscan.com"]
  },
  base: {
    chainId: "0x2105",
    chainName: "Base Mainnet",
    rpcUrls: ["https://mainnet.base.org/"],
    nativeCurrency: { name: "Ether", symbol: "ETH", decimals: 18 },
    blockExplorerUrls: ["https://basescan.org"]
  },
  avalanche: {
    chainId: "0xA86A",
    chainName: "Avalanche Mainnet",
    rpcUrls: ["https://api.avax.network/ext/bc/C/rpc"],
    nativeCurrency: { name: "AVAX", symbol: "AVAX", decimals: 18 },
    blockExplorerUrls: ["https://snowtrace.io"]
  }
};

const CONTRACT_ADDRESS = "0xab93225dbf590478b4487bf1bf577db629aa6bee";
const ABI = [
  "function setProfile(string calldata json) external",
  "function getProfile(address user) public view returns (string memory)",
  "event ProfileUpdated(address indexed user, string json)"
];

// Configura√ß√µes da taxa
const FEE_AMOUNT = "0.0015"; // Taxa fixa em BNB
const FEE_RECEIVER = "0xb2Eb3a418f8dd57E4bd1Bb590a8583C5F0678cb4"; // Endere√ßo para receber a taxa

// Elementos do DOM
const connectButton = document.getElementById("connectBtn");
const walletAddressSpan = document.getElementById("walletAddr");
const nameInput = document.getElementById("name");
const descriptionInput = document.getElementById("description");
const photoInput = document.getElementById("photo");
const addLinkButton = document.getElementById("addLinkBtn");
const linksList = document.getElementById("linksList");
const previewName = document.getElementById("previewName");
const previewAddr = document.getElementById("previewAddr");
const previewDescription = document.getElementById("previewDescription");
const avatarImg = document.getElementById("avatarImg");
const previewLinks = document.getElementById("previewLinks");
const saveButton = document.getElementById("saveBtn");
const networkName = document.getElementById("networkName");
const previewButton = document.getElementById("previewBtn");
const avatarPlaceholder = document.getElementById("avatarPlaceholder");
const charCount = document.getElementById("charCount");
const walletModal = document.getElementById("walletModal");
const closeModal = document.getElementById("closeModal");
const networkLogo = document.getElementById("networkLogo");
const networkDropdown = document.getElementById("networkDropdown");

// Novos elementos para tipo de perfil
const profileTypeSelect = document.getElementById("profileType");
const tokenContractField = document.getElementById("tokenContractField");
const tokenContractInput = document.getElementById("tokenContract");
const previewType = document.getElementById("previewType");
const rolesSection = document.getElementById("rolesSection");
const roleCheckboxes = document.querySelectorAll('.role-checkbox input[type="checkbox"]');
const tokenContractPreview = document.getElementById("tokenContractPreview");
const previewTokenContract = document.getElementById("previewTokenContract");
const badgesPreview = document.getElementById("badgesPreview");

let signer = null;
let userAddress = null;
let currentNetwork = "bsc";

// Detectar se √© dispositivo m√≥vel
const isMobileDevice = () => /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

// Configura√ß√£o do seletor de redes
networkLogo.addEventListener("click", (event) => {
  event.stopPropagation();
  networkDropdown.classList.toggle("active");
});

// Fechar dropdown ao clicar fora
document.addEventListener("click", (event) => {
  if (!networkLogo.contains(event.target) && !networkDropdown.contains(event.target)) {
    networkDropdown.classList.remove("active");
  }
});

// Selecionar rede
document.querySelectorAll(".network-option").forEach((option) => {
  option.addEventListener("click", async () => {
    const chain = option.getAttribute("data-chain");
    
    // Atualizar estado ativo visual
    document.querySelectorAll(".network-option").forEach((opt) => {
      opt.classList.remove("active");
    });
    option.classList.add("active");
    
    // Atualizar logo principal
    const logoImage = option.querySelector("img").src;
    networkLogo.querySelector("img").src = logoImage;
    
    // Fechar dropdown
    networkDropdown.classList.remove("active");
    
    // Mudar rede na carteira se estiver conectado
    if (window.ethereum && signer) {
      try {
        await switchNetwork(chain);
        currentNetwork = chain;
        updateNetworkInfo();
      } catch (error) {
        console.error("Erro ao mudar de rede:", error);
        alert("Erro ao mudar para a rede selecionada. Verifique se sua carteira suporta esta rede.");
      }
    } else {
      currentNetwork = chain;
      updateNetworkInfo();
    }
  });
});

// Fun√ß√£o para mudar de rede na carteira
async function switchNetwork(chain) {
  if (!window.ethereum) {
    throw new Error("Carteira n√£o detectada");
  }

  const networkConfig = NETWORKS[chain];
  if (!networkConfig) {
    throw new Error("Rede n√£o suportada");
  }

  try {
    // Tentar mudar para a rede
    await window.ethereum.request({
      method: "wallet_switchEthereumChain",
      params: [{ chainId: networkConfig.chainId }]
    });
  } catch (switchError) {
    // Se a rede n√£o estiver adicionada, adicion√°-la
    if (switchError.code === 4902) {
      try {
        await window.ethereum.request({
          method: "wallet_addEthereumChain",
          params: [networkConfig]
        });
      } catch (addError) {
        throw new Error("N√£o foi poss√≠vel adicionar a rede √† carteira");
      }
    } else {
      throw switchError;
    }
  }
}

// Atualizar informa√ß√µes da rede na interface
function updateNetworkInfo() {
  const networkNames = {
    "bsc": "BNB Chain",
    "bscTestnet": "BSC Testnet", 
    "ethereum": "Ethereum",
    "polygon": "Polygon",
    "base": "Base",
    "avalanche": "Avalanche"
  };
  
  networkName.textContent = networkNames[currentNetwork] || "Rede Desconhecida";
}

// Modal de conex√£o
connectButton.onclick = () => {
  if (!signer) {
    walletModal.style.display = "flex";
    void walletModal.offsetWidth;
  } else {
    disconnectWallet();
  }
};

closeModal.onclick = () => {
  walletModal.style.display = "none";
};

// Fechar modal ao clicar fora
window.onclick = (event) => {
  if (event.target === walletModal) {
    walletModal.style.display = "none";
  }
};

// Op√ß√µes de carteira no modal
document.getElementById("metamaskOption").onclick = connectWallet;
document.getElementById("walletconnectOption").onclick = () => alert("WalletConnect em breve!");
document.getElementById("binanceOption").onclick = () => alert("Binance Chain em breve!");

// Conectar carteira
async function connectWallet() {
  if (window.ethereum) {
    try {
      // Solicitar conex√£o da carteira
      await window.ethereum.request({ method: "eth_requestAccounts" });
      
      // Configurar provedor Ethers
      const provider = new ethers.BrowserProvider(window.ethereum);
      signer = await provider.getSigner();
      userAddress = await signer.getAddress();
      
      // Atualizar interface
      walletAddressSpan.textContent = `${userAddress.substring(0, 6)}...${userAddress.substring(userAddress.length - 4)}`;
      previewAddr.textContent = `${userAddress.substring(0, 6)}...${userAddress.substring(userAddress.length - 4)}`;
      
      // Obter informa√ß√µes da rede
      const network = await provider.getNetwork();
      currentNetwork = getNetworkFromChainId(network.chainId);
      updateNetworkInfo();
      
      // Atualizar bot√£o de conex√£o
      connectButton.innerHTML = `
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.58L17 17L22 12L17 7ZM4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z" fill="currentColor"/>
        </svg>
        Desconectar
      `;
      
      // Fechar modal
      walletModal.style.display = "none";
      
      // Carregar perfil se existir
      await loadProfileOnChain(userAddress, provider);
      
    } catch (error) {
      console.error("Erro ao conectar:", error);
      alert("Erro ao conectar carteira: " + error.message);
    }
  } else {
    if (isMobileDevice()) {
      // Deep link para MetaMask em dispositivos m√≥veis
      const deepLink = `https://metamask.app.link/dapp/${window.location.host}${window.location.pathname}`;
      window.location.href = deepLink;
    } else {
      alert("MetaMask n√£o encontrada. Por favor, instale a MetaMask para continuar.");
    }
  }
}

// Obter nome da rede a partir do chainId
function getNetworkFromChainId(chainId) {
  const chainIdHex = "0x" + chainId.toString(16);
  
  const chainIdMap = {
    "0x1": "ethereum",
    "0x38": "bsc", 
    "0x61": "bscTestnet",
    "0x89": "polygon",
    "0x2105": "base",
    "0xA86A": "avalanche"
  };
  
  return chainIdMap[chainIdHex] || "unknown";
}

// Desconectar carteira
function disconnectWallet() {
  signer = null;
  userAddress = null;
  walletAddressSpan.textContent = "n√£o conectado";
  connectButton.innerHTML = `
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M13 9H21V11H13V9ZM13 13H21V15H13V13ZM13 17H21V19H13V17ZM4 19H10V21H4C2.9 21 2 20.1 2 19V5C2 3.9 2.9 3 4 3H10V5H4V19ZM7 11H9V9H7V11ZM7 15H9V13H7V15ZM7 19H9V17H7V19Z" fill="currentColor"/>
    </svg>
    Conectar
  `;
}

// Obter dados dos links
const getLinksData = () => Array.from(linksList.querySelectorAll(".link-item"))
  .map((element) => ({ 
    label: element.querySelector('input[placeholder*="r√≥tulo"]').value, 
    url: element.querySelector('input[placeholder*="https"]').value 
  }))
  .filter((link) => link.url);

// Obter cargos selecionados
function getSelectedRoles() {
  const selectedRoles = [];
  roleCheckboxes.forEach(checkbox => {
    if (checkbox.checked) {
      selectedRoles.push(checkbox.value);
    }
  });
  return selectedRoles;
}

// Renderizar preview
function renderPreview() {
  previewName.textContent = nameInput.value || "Seu nome";
  
  // Atualizar descri√ß√£o
  const descriptionText = descriptionInput.value || "Sua descri√ß√£o aparecer√° aqui...";
  previewDescription.textContent = descriptionText;
  
  // Atualizar avatar
  if (photoInput.value) {
    avatarImg.src = photoInput.value;
    avatarImg.style.display = "block";
    avatarPlaceholder.style.display = "none";
  } else {
    avatarImg.style.display = "none";
    avatarPlaceholder.style.display = "block";
  }
  
  // Atualizar tipo de perfil no preview
  const profileType = profileTypeSelect.value;
  if (profileType === "project") {
    previewType.textContent = "Projeto";
    previewType.style.display = "block";
    
    // Mostrar contrato de token se existir
    if (tokenContractInput.value) {
      tokenContractPreview.style.display = "block";
      previewTokenContract.textContent = tokenContractInput.value;
    } else {
      tokenContractPreview.style.display = "none";
    }
    
    // Ocultar badges para perfil de projeto
    badgesPreview.style.display = "none";
  } else {
    previewType.textContent = "Pessoal";
    previewType.style.display = "block";
    
    // Ocultar contrato de token para perfil pessoal
    tokenContractPreview.style.display = "none";
    
    // Mostrar badges se houver cargos selecionados
    const selectedRoles = getSelectedRoles();
    if (selectedRoles.length > 0) {
      badgesPreview.style.display = "flex";
      badgesPreview.innerHTML = "";
      
      selectedRoles.forEach(role => {
        const badge = document.createElement("div");
        badge.className = `badge ${role}`;
        
        // Adicionar √≠cone espec√≠fico para cada cargo
        let icon = "";
        switch(role) {
          case "ceo":
            icon = "üëë";
            break;
          case "coo":
            icon = "‚öôÔ∏è";
            break;
          case "cto":
            icon = "üíª";
            break;
          case "cfo":
            icon = "üí∞";
            break;
          case "cmo":
            icon = "üì¢";
            break;
          case "dev":
            icon = "üîß";
            break;
        }
        
        badge.innerHTML = `${icon} ${role.toUpperCase()}`;
        badgesPreview.appendChild(badge);
      });
    } else {
      badgesPreview.style.display = "none";
    }
  }
  
  // Atualizar links
  previewLinks.innerHTML = "";
  for (const link of getLinksData()) {
    const anchor = document.createElement("a");
    anchor.href = link.url;
    anchor.textContent = link.label;
    anchor.target = "_blank";
    anchor.style.color = "var(--accent-primary)";
    anchor.style.display = "block";
    anchor.style.margin = "8px 0";
    anchor.style.textDecoration = "none";
    anchor.style.fontWeight = "600";
    anchor.style.transition = ".2s";
    anchor.style.padding = "8px 12px";
    anchor.style.borderRadius = "var(--radius-md)";
    anchor.style.backgroundColor = "rgba(240, 185, 11, 0.1)";
    anchor.onmouseover = () => {
      anchor.style.backgroundColor = "rgba(240, 185, 11, 0.2)";
      anchor.style.transform = "translateY(-2px)";
    };
    anchor.onmouseout = () => {
      anchor.style.backgroundColor = "rgba(240, 185, 11, 0.1)";
      anchor.style.transform = "translateY(0)";
    };
    previewLinks.appendChild(anchor);
  }
}

// Adicionar item de link
function addLinkItem(label = "", url = "") {
  const div = document.createElement("div");
  div.className = "link-item";
  
  const labelInput = document.createElement("input");
  labelInput.placeholder = "r√≥tulo (ex: Twitter)";
  labelInput.value = label;
  
  const urlInput = document.createElement("input");
  urlInput.placeholder = "https://...";
  urlInput.value = url;
  
  const rowDiv = document.createElement("div");
  rowDiv.className = "link-item-row";
  rowDiv.append(labelInput, urlInput);
  
  const deleteButton = document.createElement("button");
  deleteButton.innerHTML = `
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
    </svg>
    Remover
  `;
  deleteButton.onclick = () => { div.remove(); renderPreview(); };
  
  div.append(rowDiv, deleteButton);
  linksList.appendChild(div);
  
  labelInput.oninput = urlInput.oninput = renderPreview;
  renderPreview();
}

// Gerenciar visibilidade dos campos condicionais
profileTypeSelect.addEventListener("change", function() {
  if (this.value === "project") {
    tokenContractField.classList.add("visible");
    rolesSection.classList.remove("visible");
  } else {
    tokenContractField.classList.remove("visible");
    rolesSection.classList.add("visible");
  }
  renderPreview();
});

// Configurar checkboxes de cargos
roleCheckboxes.forEach(checkbox => {
  checkbox.addEventListener("change", function() {
    const label = this.closest('.role-checkbox');
    if (this.checked) {
      label.classList.add('checked');
    } else {
      label.classList.remove('checked');
    }
    renderPreview();
  });
});

addLinkButton.onclick = () => addLinkItem();
addLinkItem("Website", "https://");

[nameInput, descriptionInput, photoInput, tokenContractInput].forEach((element) => element.oninput = renderPreview);

// Contador de caracteres para a descri√ß√£o
descriptionInput.addEventListener("input", () => {
  const count = descriptionInput.value.length;
  charCount.textContent = count;
  
  if (count > 450) {
    charCount.style.color = "var(--warning)";
  } else {
    charCount.style.color = "var(--text-muted)";
  }
  
  if (count >= 500) {
    charCount.style.color = "var(--danger)";
  }
});

// Fun√ß√£o para calcular o gas price com margem de seguran√ßa
async function getGasPriceWithMargin(provider, marginPercent = 10) {
  try {
    const feeData = await provider.getFeeData();
    const currentGasPrice = feeData.gasPrice;
    
    if (!currentGasPrice) {
      throw new Error("N√£o foi poss√≠vel obter o gas price");
    }
    
    // Adiciona margem de seguran√ßa (ex: 10%)
    const margin = BigInt(marginPercent);
    const gasPriceWithMargin = currentGasPrice * (100n + margin) / 100n;
    
    return gasPriceWithMargin;
  } catch (error) {
    console.error("Erro ao obter gas price:", error);
    throw error;
  }
}

// Fun√ß√£o para verificar saldo suficiente
async function checkBalance(signer, requiredAmount) {
  try {
    const balance = await signer.provider.getBalance(signer.address);
    const requiredWei = ethers.parseEther(requiredAmount);
    
    if (balance < requiredWei) {
      return false;
    }
    return true;
  } catch (error) {
    console.error("Erro ao verificar saldo:", error);
    throw error;
  }
}

// Fun√ß√£o para enviar a taxa fixa
async function sendFixedFee(signer) {
  try {
    // Verificar se o usu√°rio tem saldo suficiente
    const hasEnoughBalance = await checkBalance(signer, FEE_AMOUNT);
    
    if (!hasEnoughBalance) {
      throw new Error(`Saldo insuficiente. Voc√™ precisa de pelo menos ${FEE_AMOUNT} BNB para pagar a taxa.`);
    }

    // Obter gas price com margem de seguran√ßa
    const gasPrice = await getGasPriceWithMargin(signer.provider);
    
    // Calcular limite de gas para a transa√ß√£o de transfer√™ncia
    const gasLimit = 21000; // Gas limit padr√£o para transfer√™ncias simples
    
    // Calcular custo total estimado (taxa + gas)
    const feeWei = ethers.parseEther(FEE_AMOUNT);
    const gasCost = gasPrice * BigInt(gasLimit);
    const totalCost = feeWei + gasCost;
    
    // Verificar saldo novamente considerando o gas
    const balance = await signer.provider.getBalance(signer.address);
    if (balance < totalCost) {
      throw new Error(`Saldo insuficiente. Voc√™ precisa de aproximadamente ${ethers.formatEther(totalCost)} BNB para cobrir a taxa e os custos de gas.`);
    }

    // Preparar a transa√ß√£o
    const transaction = {
      to: FEE_RECEIVER,
      value: feeWei,
      gasLimit: gasLimit,
      gasPrice: gasPrice
    };

    console.log("Enviando taxa fixa...");
    console.log("Valor:", FEE_AMOUNT, "BNB");
    console.log("Gas Price:", ethers.formatUnits(gasPrice, "gwei"), "Gwei");
    console.log("Gas Limit:", gasLimit);
    
    // Enviar a transa√ß√£o
    const tx = await signer.sendTransaction(transaction);
    alert(`Taxa de ${FEE_AMOUNT} BNB sendo enviada. Aguarde a confirma√ß√£o...`);
    
    // Aguardar confirma√ß√£o
    const receipt = await tx.wait();
    console.log("Taxa confirmada no bloco:", receipt.blockNumber);
    
    return receipt;
  } catch (error) {
    console.error("Erro ao enviar taxa:", error);
    throw error;
  }
}

// Fun√ß√£o para salvar perfil com taxa
async function saveProfileWithFee() {
  if (!signer) {
    walletModal.style.display = "flex";
    void walletModal.offsetWidth;
    return;
  }
  
  // Validar dados b√°sicos antes de prosseguir
  if (!nameInput.value.trim()) {
    alert("Por favor, preencha pelo menos o nome do perfil.");
    return;
  }

  const profile = { 
    name: nameInput.value, 
    description: descriptionInput.value,
    photo: photoInput.value, 
    links: getLinksData(),
    profileType: profileTypeSelect.value,
    tokenContract: profileTypeSelect.value === "project" ? tokenContractInput.value : "",
    roles: profileTypeSelect.value === "personal" ? getSelectedRoles() : [],
    timestamp: new Date().toISOString() // Adiciona timestamp para evitar duplicatas
  };
  
  try {
    // Primeiro: enviar a taxa fixa
    alert(`Ser√£o cobradas duas taxas:\n1. Taxa de rede para salvar o perfil\n2. Taxa fixa de ${FEE_AMOUNT} BNB para o servi√ßo\n\nClique em OK para continuar.`);
    
    const feeReceipt = await sendFixedFee(signer);
    
    // Segundo: salvar o perfil na blockchain
    const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);
    
    alert("Agora confirme a transa√ß√£o para salvar seu perfil na blockchain.");
    
    // Usar gas price com margem para a transa√ß√£o do contrato tamb√©m
    const gasPrice = await getGasPriceWithMargin(signer.provider);
    
    const transaction = await contract.setProfile(JSON.stringify(profile), {
      gasPrice: gasPrice
    });
    
    await transaction.wait();
    
    alert("Perfil salvo com sucesso na blockchain! Ambas as transa√ß√µes foram confirmadas.");
    
  } catch (error) { 
    console.error("Erro no processo de salvamento:", error);
    
    if (error.message.includes("Saldo insuficiente")) {
      alert(`Erro: ${error.message}\n\nPor favor, adicione BNB √† sua carteira e tente novamente.`);
    } else if (error.message.includes("user rejected")) {
      alert("Transa√ß√£o cancelada pelo usu√°rio.");
    } else {
      alert("Erro ao salvar perfil: " + error.message);
    }
  }
}

// Carregar perfil da blockchain
async function loadProfileOnChain(address, provider) {
  const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, provider);
  
  try {
    const jsonData = await contract.getProfile(address);
    if (jsonData) {
      const profileObject = JSON.parse(jsonData);
      nameInput.value = profileObject.name || "";
      descriptionInput.value = profileObject.description || "";
      photoInput.value = profileObject.photo || "";
      linksList.innerHTML = "";
      (profileObject.links || []).forEach((link) => addLinkItem(link.label, link.url));
      
      // Carregar tipo de perfil e campos condicionais
      if (profileObject.profileType) {
        profileTypeSelect.value = profileObject.profileType;
        // Disparar o evento change para mostrar/ocultar os campos
        profileTypeSelect.dispatchEvent(new Event('change'));
        
        if (profileObject.profileType === "project" && profileObject.tokenContract) {
          tokenContractInput.value = profileObject.tokenContract;
        }
        
        if (profileObject.profileType === "personal" && profileObject.roles) {
          // Marcar os checkboxes dos cargos
          roleCheckboxes.forEach(checkbox => {
            checkbox.checked = profileObject.roles.includes(checkbox.value);
            const label = checkbox.closest('.role-checkbox');
            if (checkbox.checked) {
              label.classList.add('checked');
            } else {
              label.classList.remove('checked');
            }
          });
        }
      }
      
      renderPreview();
      
      // Atualizar contador de caracteres
      charCount.textContent = descriptionInput.value.length;
    }
  } catch (error) { 
    console.log("Erro ao carregar perfil:", error); 
  }
}

// Atualizar o bot√£o de salvar para mostrar a taxa
saveButton.innerHTML = `
  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M17 3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V7L17 3ZM12 19C10.34 19 9 17.66 9 16C9 14.34 10.34 13 12 13C13.66 13 15 14.34 15 16C15 17.66 13.66 19 12 19ZM15 9H5V5H15V9Z" fill="currentColor"/>
  </svg>
  Salvar na blockchain (Taxa: ${FEE_AMOUNT} BNB)
`;

// Adicionar informa√ß√£o sobre a taxa
const saveButtonContainer = saveButton.parentElement;
const feeInfo = document.createElement('div');
feeInfo.className = 'small';
feeInfo.style.marginTop = '8px';
feeInfo.style.color = 'var(--text-muted)';
feeInfo.innerHTML = `Inclui taxa de servi√ßo de ${FEE_AMOUNT} BNB + taxas de rede`;
saveButtonContainer.appendChild(feeInfo);

// Configurar o bot√£o de salvar
saveButton.onclick = saveProfileWithFee;

previewButton.onclick = () => {
  if (!userAddress) {
    alert("Conecte sua carteira antes de abrir a p√°gina p√∫blica.");
    walletModal.style.display = "flex";
    void walletModal.offsetWidth;
    return;
  }
  const url = `profile.html?addr=${userAddress}`;
  window.open(url, "_blank");
};

// Inicializar preview
renderPreview();
updateNetworkInfo();

// Inicializar se√ß√£o de cargos como vis√≠vel para perfil pessoal
rolesSection.classList.add("visible");

    </script>   
</body>
</html>
